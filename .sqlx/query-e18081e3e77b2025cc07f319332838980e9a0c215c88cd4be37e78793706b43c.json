{
  "db_name": "PostgreSQL",
  "query": "WITH hits AS (\n\tSELECT *\n\tFROM unnest(\n\t\t$1::uuid[],\n\t\t$2::uuid[],\n\t\t$3::uuid[],\n\t\t$4::int4[],\n\t\t$5::real[]\n\t) AS t(hit_id, note_id, chunk_id, rank, final_score)\n),\nupdated AS (\n\tUPDATE memory_notes\n\tSET\n\t\thit_count = hit_count + 1,\n\t\tlast_hit_at = $6\n\tWHERE note_id = ANY($2)\n)\nINSERT INTO memory_hits (\n\thit_id,\n\tnote_id,\n\tchunk_id,\n\tquery_hash,\n\trank,\n\tfinal_score,\n\tts\n)\nSELECT\n\thit_id,\n\tnote_id,\n\tchunk_id,\n\t$7,\n\trank,\n\tfinal_score,\n\t$6\nFROM hits",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": [
        "UuidArray",
        "UuidArray",
        "UuidArray",
        "Int4Array",
        "Float4Array",
        "Timestamptz",
        "Text"
      ]
    },
    "nullable": []
  },
  "hash": "e18081e3e77b2025cc07f319332838980e9a0c215c88cd4be37e78793706b43c"
}
