BEGIN;

INSERT INTO search_traces (
	trace_id,
	tenant_id,
	project_id,
	agent_id,
	read_profile,
	query,
	expansion_mode,
	expanded_queries,
	allowed_scopes,
	candidate_count,
	top_k,
	config_snapshot,
	trace_version,
	created_at,
	expires_at
)
VALUES
	(
		'11111111-1111-1111-1111-111111111111',
		't',
		'p',
		'a',
		'private_only',
		'alpha trace gate query',
		'off',
		'[]'::jsonb,
		'["agent_private"]'::jsonb,
		5,
		3,
		'{}'::jsonb,
		3,
		'2026-02-01T00:00:00Z'::timestamptz,
		'2027-02-01T00:00:00Z'::timestamptz
	),
	(
		'22222222-2222-2222-2222-222222222222',
		't',
		'p',
		'a',
		'private_only',
		'beta trace gate query',
		'off',
		'[]'::jsonb,
		'["agent_private"]'::jsonb,
		5,
		3,
		'{}'::jsonb,
		3,
		'2026-02-02T00:00:00Z'::timestamptz,
		'2027-02-02T00:00:00Z'::timestamptz
	),
	(
		'33333333-3333-3333-3333-333333333333',
		't',
		'p',
		'a',
		'private_only',
		'gamma trace gate query',
		'off',
		'[]'::jsonb,
		'["agent_private"]'::jsonb,
		6,
		3,
		'{}'::jsonb,
		3,
		'2026-02-03T00:00:00Z'::timestamptz,
		'2027-02-03T00:00:00Z'::timestamptz
	),
	(
		'44444444-4444-4444-4444-444444444444',
		't',
		'p',
		'a',
		'private_only',
		'delta trace gate query',
		'off',
		'[]'::jsonb,
		'["agent_private"]'::jsonb,
		6,
		3,
		'{}'::jsonb,
		3,
		'2026-02-04T00:00:00Z'::timestamptz,
		'2027-02-04T00:00:00Z'::timestamptz
	);

INSERT INTO search_trace_candidates (
	candidate_id,
	trace_id,
	note_id,
	chunk_id,
	chunk_index,
	snippet,
	candidate_snapshot,
	retrieval_rank,
	rerank_score,
	note_scope,
	note_importance,
	note_updated_at,
	note_hit_count,
	note_last_hit_at,
	created_at,
	expires_at
)
VALUES
	-- Trace 1
	(
		'aaaaaaaa-0000-0000-0000-000000000001',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111111',
		'aaaaaaaa-2222-2222-2222-222222222221',
		0,
		'alpha candidate 1',
		'{}'::jsonb,
		1,
		0.90,
		'agent_private',
		0.50,
		'2026-01-31T00:00:00Z'::timestamptz,
		10,
		NULL,
		'2026-02-01T00:00:00Z'::timestamptz,
		'2027-02-01T00:00:00Z'::timestamptz
	),
	(
		'aaaaaaaa-0000-0000-0000-000000000002',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111112',
		'aaaaaaaa-2222-2222-2222-222222222222',
		0,
		'alpha candidate 2',
		'{}'::jsonb,
		2,
		0.80,
		'agent_private',
		0.40,
		'2026-01-31T00:00:00Z'::timestamptz,
		9,
		NULL,
		'2026-02-01T00:00:00Z'::timestamptz,
		'2027-02-01T00:00:00Z'::timestamptz
	),
	(
		'aaaaaaaa-0000-0000-0000-000000000003',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111113',
		'aaaaaaaa-2222-2222-2222-222222222223',
		0,
		'alpha candidate 3',
		'{}'::jsonb,
		3,
		0.70,
		'agent_private',
		0.30,
		'2026-01-31T00:00:00Z'::timestamptz,
		8,
		NULL,
		'2026-02-01T00:00:00Z'::timestamptz,
		'2027-02-01T00:00:00Z'::timestamptz
	),
	(
		'aaaaaaaa-0000-0000-0000-000000000004',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111114',
		'aaaaaaaa-2222-2222-2222-222222222224',
		0,
		'alpha candidate 4',
		'{}'::jsonb,
		4,
		0.10,
		'agent_private',
		0.20,
		'2026-01-31T00:00:00Z'::timestamptz,
		7,
		NULL,
		'2026-02-01T00:00:00Z'::timestamptz,
		'2027-02-01T00:00:00Z'::timestamptz
	),
	(
		'aaaaaaaa-0000-0000-0000-000000000005',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111115',
		'aaaaaaaa-2222-2222-2222-222222222225',
		0,
		'alpha candidate 5',
		'{}'::jsonb,
		5,
		0.05,
		'agent_private',
		0.10,
		'2026-01-31T00:00:00Z'::timestamptz,
		6,
		NULL,
		'2026-02-01T00:00:00Z'::timestamptz,
		'2027-02-01T00:00:00Z'::timestamptz
	),
	-- Trace 2
	(
		'bbbbbbbb-0000-0000-0000-000000000001',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111111',
		'bbbbbbbb-2222-2222-2222-222222222221',
		0,
		'beta candidate 1',
		'{}'::jsonb,
		1,
		0.95,
		'agent_private',
		0.50,
		'2026-02-01T00:00:00Z'::timestamptz,
		10,
		NULL,
		'2026-02-02T00:00:00Z'::timestamptz,
		'2027-02-02T00:00:00Z'::timestamptz
	),
	(
		'bbbbbbbb-0000-0000-0000-000000000002',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111112',
		'bbbbbbbb-2222-2222-2222-222222222222',
		0,
		'beta candidate 2',
		'{}'::jsonb,
		2,
		0.60,
		'agent_private',
		0.40,
		'2026-02-01T00:00:00Z'::timestamptz,
		9,
		NULL,
		'2026-02-02T00:00:00Z'::timestamptz,
		'2027-02-02T00:00:00Z'::timestamptz
	),
	(
		'bbbbbbbb-0000-0000-0000-000000000003',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111113',
		'bbbbbbbb-2222-2222-2222-222222222223',
		0,
		'beta candidate 3',
		'{}'::jsonb,
		3,
		0.50,
		'agent_private',
		0.30,
		'2026-02-01T00:00:00Z'::timestamptz,
		8,
		NULL,
		'2026-02-02T00:00:00Z'::timestamptz,
		'2027-02-02T00:00:00Z'::timestamptz
	),
	(
		'bbbbbbbb-0000-0000-0000-000000000004',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111114',
		'bbbbbbbb-2222-2222-2222-222222222224',
		0,
		'beta candidate 4',
		'{}'::jsonb,
		4,
		0.20,
		'agent_private',
		0.20,
		'2026-02-01T00:00:00Z'::timestamptz,
		7,
		NULL,
		'2026-02-02T00:00:00Z'::timestamptz,
		'2027-02-02T00:00:00Z'::timestamptz
	),
	(
		'bbbbbbbb-0000-0000-0000-000000000005',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111115',
		'bbbbbbbb-2222-2222-2222-222222222225',
		0,
		'beta candidate 5',
		'{}'::jsonb,
		5,
		0.10,
		'agent_private',
		0.10,
		'2026-02-01T00:00:00Z'::timestamptz,
		6,
		NULL,
		'2026-02-02T00:00:00Z'::timestamptz,
		'2027-02-02T00:00:00Z'::timestamptz
	),
	-- Trace 3
	(
		'eeeeeeee-0000-0000-0000-000000000001',
		'33333333-3333-3333-3333-333333333333',
		'eeeeeeee-1111-1111-1111-111111111111',
		'eeeeeeee-2222-2222-2222-222222222221',
		0,
		'gamma candidate 1',
		'{"note_id":"eeeeeeee-1111-1111-1111-111111111111","chunk_id":"eeeeeeee-2222-2222-2222-222222222221","chunk_index":0,"snippet":"gamma candidate 1","retrieval_rank":1,"rerank_score":0.95,"note_scope":"agent_private","note_importance":0.60,"note_updated_at":"2026-02-02T00:00:00Z","note_hit_count":11,"note_last_hit_at":"2026-02-02T12:00:00Z"}'::jsonb,
		1,
		0.95,
		'agent_private',
		0.60,
		'2026-02-02T00:00:00Z'::timestamptz,
		11,
		'2026-02-02T12:00:00Z'::timestamptz,
		'2026-02-03T00:00:00Z'::timestamptz,
		'2027-02-03T00:00:00Z'::timestamptz
	),
	(
		'eeeeeeee-0000-0000-0000-000000000002',
		'33333333-3333-3333-3333-333333333333',
		'eeeeeeee-1111-1111-1111-111111111112',
		'eeeeeeee-2222-2222-2222-222222222222',
		0,
		'gamma candidate 2',
		'{}'::jsonb,
		2,
		0.85,
		'agent_private',
		0.50,
		'2026-02-02T00:00:00Z'::timestamptz,
		10,
		NULL,
		'2026-02-03T00:00:00Z'::timestamptz,
		'2027-02-03T00:00:00Z'::timestamptz
	),
	(
		'eeeeeeee-0000-0000-0000-000000000003',
		'33333333-3333-3333-3333-333333333333',
		'eeeeeeee-1111-1111-1111-111111111113',
		'eeeeeeee-2222-2222-2222-222222222223',
		0,
		'gamma candidate 3',
		'{}'::jsonb,
		3,
		0.75,
		'agent_private',
		0.40,
		'2026-02-02T00:00:00Z'::timestamptz,
		9,
		NULL,
		'2026-02-03T00:00:00Z'::timestamptz,
		'2027-02-03T00:00:00Z'::timestamptz
	),
	(
		'eeeeeeee-0000-0000-0000-000000000004',
		'33333333-3333-3333-3333-333333333333',
		'eeeeeeee-1111-1111-1111-111111111114',
		'eeeeeeee-2222-2222-2222-222222222224',
		0,
		'gamma candidate 4',
		'{}'::jsonb,
		4,
		0.65,
		'agent_private',
		0.30,
		'2026-02-02T00:00:00Z'::timestamptz,
		8,
		NULL,
		'2026-02-03T00:00:00Z'::timestamptz,
		'2027-02-03T00:00:00Z'::timestamptz
	),
	(
		'eeeeeeee-0000-0000-0000-000000000005',
		'33333333-3333-3333-3333-333333333333',
		'eeeeeeee-1111-1111-1111-111111111115',
		'eeeeeeee-2222-2222-2222-222222222225',
		0,
		'gamma candidate 5',
		'{}'::jsonb,
		5,
		0.55,
		'agent_private',
		0.20,
		'2026-02-02T00:00:00Z'::timestamptz,
		7,
		NULL,
		'2026-02-03T00:00:00Z'::timestamptz,
		'2027-02-03T00:00:00Z'::timestamptz
	),
	(
		'eeeeeeee-0000-0000-0000-000000000006',
		'33333333-3333-3333-3333-333333333333',
		'eeeeeeee-1111-1111-1111-111111111116',
		'eeeeeeee-2222-2222-2222-222222222226',
		0,
		'gamma candidate 6',
		'{}'::jsonb,
		6,
		0.45,
		'agent_private',
		0.10,
		'2026-02-02T00:00:00Z'::timestamptz,
		6,
		NULL,
		'2026-02-03T00:00:00Z'::timestamptz,
		'2027-02-03T00:00:00Z'::timestamptz
	),
	-- Trace 4
	(
		'ffffffff-0000-0000-0000-000000000001',
		'44444444-4444-4444-4444-444444444444',
		'ffffffff-1111-1111-1111-111111111111',
		'ffffffff-2222-2222-2222-222222222221',
		1,
		'delta candidate 1',
		'{}'::jsonb,
		1,
		0.92,
		'agent_private',
		0.55,
		'2026-02-03T00:00:00Z'::timestamptz,
		10,
		'2026-02-03T12:00:00Z'::timestamptz,
		'2026-02-04T00:00:00Z'::timestamptz,
		'2027-02-04T00:00:00Z'::timestamptz
	),
	(
		'ffffffff-0000-0000-0000-000000000002',
		'44444444-4444-4444-4444-444444444444',
		'ffffffff-1111-1111-1111-111111111112',
		'ffffffff-2222-2222-2222-222222222222',
		1,
		'delta candidate 2',
		'{}'::jsonb,
		2,
		0.82,
		'agent_private',
		0.45,
		'2026-02-03T00:00:00Z'::timestamptz,
		9,
		NULL,
		'2026-02-04T00:00:00Z'::timestamptz,
		'2027-02-04T00:00:00Z'::timestamptz
	),
	(
		'ffffffff-0000-0000-0000-000000000003',
		'44444444-4444-4444-4444-444444444444',
		'ffffffff-1111-1111-1111-111111111113',
		'ffffffff-2222-2222-2222-222222222223',
		1,
		'delta candidate 3',
		'{}'::jsonb,
		3,
		0.72,
		'agent_private',
		0.35,
		'2026-02-03T00:00:00Z'::timestamptz,
		8,
		NULL,
		'2026-02-04T00:00:00Z'::timestamptz,
		'2027-02-04T00:00:00Z'::timestamptz
	),
	(
		'ffffffff-0000-0000-0000-000000000004',
		'44444444-4444-4444-4444-444444444444',
		'ffffffff-1111-1111-1111-111111111114',
		'ffffffff-2222-2222-2222-222222222224',
		1,
		'delta candidate 4',
		'{}'::jsonb,
		4,
		0.62,
		'agent_private',
		0.25,
		'2026-02-03T00:00:00Z'::timestamptz,
		7,
		NULL,
		'2026-02-04T00:00:00Z'::timestamptz,
		'2027-02-04T00:00:00Z'::timestamptz
	),
	(
		'ffffffff-0000-0000-0000-000000000005',
		'44444444-4444-4444-4444-444444444444',
		'ffffffff-1111-1111-1111-111111111115',
		'ffffffff-2222-2222-2222-222222222225',
		1,
		'delta candidate 5',
		'{}'::jsonb,
		5,
		0.52,
		'agent_private',
		0.15,
		'2026-02-03T00:00:00Z'::timestamptz,
		6,
		NULL,
		'2026-02-04T00:00:00Z'::timestamptz,
		'2027-02-04T00:00:00Z'::timestamptz
	),
	(
		'ffffffff-0000-0000-0000-000000000006',
		'44444444-4444-4444-4444-444444444444',
		'ffffffff-1111-1111-1111-111111111116',
		'ffffffff-2222-2222-2222-222222222226',
		1,
		'delta candidate 6',
		'{}'::jsonb,
		6,
		0.42,
		'agent_private',
		0.05,
		'2026-02-03T00:00:00Z'::timestamptz,
		5,
		NULL,
		'2026-02-04T00:00:00Z'::timestamptz,
		'2027-02-04T00:00:00Z'::timestamptz
	);

INSERT INTO search_trace_items (
	item_id,
	trace_id,
	note_id,
	chunk_id,
	rank,
	final_score,
	explain
)
VALUES
	-- Trace 1 baseline top_k = 3 (ordered by rerank_score desc)
	(
		'cccccccc-0000-0000-0000-000000000001',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111111',
		'aaaaaaaa-2222-2222-2222-222222222221',
		1,
		1.00,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":1.0,"terms":[]}}'::jsonb
	),
	(
		'cccccccc-0000-0000-0000-000000000002',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111112',
		'aaaaaaaa-2222-2222-2222-222222222222',
		2,
		0.80,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":0.8,"terms":[]}}'::jsonb
	),
	(
		'cccccccc-0000-0000-0000-000000000003',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111113',
		'aaaaaaaa-2222-2222-2222-222222222223',
		3,
		0.60,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":0.6,"terms":[]}}'::jsonb
	),
	-- Trace 2 baseline top_k = 3 (ordered by rerank_score desc)
	(
		'dddddddd-0000-0000-0000-000000000001',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111111',
		'bbbbbbbb-2222-2222-2222-222222222221',
		1,
		1.00,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":1.0,"terms":[]}}'::jsonb
	),
	(
		'dddddddd-0000-0000-0000-000000000002',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111112',
		'bbbbbbbb-2222-2222-2222-222222222222',
		2,
		0.75,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":0.75,"terms":[]}}'::jsonb
	),
	(
		'dddddddd-0000-0000-0000-000000000003',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111113',
		'bbbbbbbb-2222-2222-2222-222222222223',
		3,
		0.60,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":0.6,"terms":[]}}'::jsonb
	),
	-- Trace 3 baseline top_k = 3 (ordered by rerank_score desc)
	(
		'eeeeeeee-9999-0000-0000-000000000001',
		'33333333-3333-3333-3333-333333333333',
		'eeeeeeee-1111-1111-1111-111111111111',
		'eeeeeeee-2222-2222-2222-222222222221',
		1,
		1.00,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":1.0,"terms":[]}}'::jsonb
	),
	(
		'eeeeeeee-9999-0000-0000-000000000002',
		'33333333-3333-3333-3333-333333333333',
		'eeeeeeee-1111-1111-1111-111111111112',
		'eeeeeeee-2222-2222-2222-222222222222',
		2,
		0.85,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":0.85,"terms":[]}}'::jsonb
	),
	(
		'eeeeeeee-9999-0000-0000-000000000003',
		'33333333-3333-3333-3333-333333333333',
		'eeeeeeee-1111-1111-1111-111111111113',
		'eeeeeeee-2222-2222-2222-222222222223',
		3,
		0.75,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":0.75,"terms":[]}}'::jsonb
	),
	-- Trace 4 baseline top_k = 3 (ordered by rerank_score desc)
	(
		'ffffffff-9999-0000-0000-000000000001',
		'44444444-4444-4444-4444-444444444444',
		'ffffffff-1111-1111-1111-111111111111',
		'ffffffff-2222-2222-2222-222222222221',
		1,
		1.00,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":1.0,"terms":[]}}'::jsonb
	),
	(
		'ffffffff-9999-0000-0000-000000000002',
		'44444444-4444-4444-4444-444444444444',
		'ffffffff-1111-1111-1111-111111111112',
		'ffffffff-2222-2222-2222-222222222222',
		2,
		0.82,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":0.82,"terms":[]}}'::jsonb
	),
	(
		'ffffffff-9999-0000-0000-000000000003',
		'44444444-4444-4444-4444-444444444444',
		'ffffffff-1111-1111-1111-111111111113',
		'ffffffff-2222-2222-2222-222222222223',
		3,
		0.72,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":0.72,"terms":[]}}'::jsonb
	);

COMMIT;
