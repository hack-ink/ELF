BEGIN;

INSERT INTO search_traces (
	trace_id,
	tenant_id,
	project_id,
	agent_id,
	read_profile,
	query,
	expansion_mode,
	expanded_queries,
	allowed_scopes,
	candidate_count,
	top_k,
	config_snapshot,
	trace_version,
	created_at,
	expires_at
)
VALUES
	(
		'11111111-1111-1111-1111-111111111111',
		't',
		'p',
		'a',
		'private_only',
		'alpha trace gate query',
		'off',
		'[]'::jsonb,
		'["agent_private"]'::jsonb,
		5,
		3,
		'{}'::jsonb,
		3,
		'2026-02-01T00:00:00Z'::timestamptz,
		'2027-02-01T00:00:00Z'::timestamptz
	),
	(
		'22222222-2222-2222-2222-222222222222',
		't',
		'p',
		'a',
		'private_only',
		'beta trace gate query',
		'off',
		'[]'::jsonb,
		'["agent_private"]'::jsonb,
		5,
		3,
		'{}'::jsonb,
		3,
		'2026-02-02T00:00:00Z'::timestamptz,
		'2027-02-02T00:00:00Z'::timestamptz
	);

INSERT INTO search_trace_candidates (
	candidate_id,
	trace_id,
	note_id,
	chunk_id,
	chunk_index,
	snippet,
	candidate_snapshot,
	retrieval_rank,
	rerank_score,
	note_scope,
	note_importance,
	note_updated_at,
	note_hit_count,
	note_last_hit_at,
	created_at,
	expires_at
)
VALUES
	-- Trace 1
	(
		'aaaaaaaa-0000-0000-0000-000000000001',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111111',
		'aaaaaaaa-2222-2222-2222-222222222221',
		0,
		'alpha candidate 1',
		'{}'::jsonb,
		1,
		0.90,
		'agent_private',
		0.50,
		'2026-01-31T00:00:00Z'::timestamptz,
		10,
		NULL,
		'2026-02-01T00:00:00Z'::timestamptz,
		'2027-02-01T00:00:00Z'::timestamptz
	),
	(
		'aaaaaaaa-0000-0000-0000-000000000002',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111112',
		'aaaaaaaa-2222-2222-2222-222222222222',
		0,
		'alpha candidate 2',
		'{}'::jsonb,
		2,
		0.80,
		'agent_private',
		0.40,
		'2026-01-31T00:00:00Z'::timestamptz,
		9,
		NULL,
		'2026-02-01T00:00:00Z'::timestamptz,
		'2027-02-01T00:00:00Z'::timestamptz
	),
	(
		'aaaaaaaa-0000-0000-0000-000000000003',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111113',
		'aaaaaaaa-2222-2222-2222-222222222223',
		0,
		'alpha candidate 3',
		'{}'::jsonb,
		3,
		0.70,
		'agent_private',
		0.30,
		'2026-01-31T00:00:00Z'::timestamptz,
		8,
		NULL,
		'2026-02-01T00:00:00Z'::timestamptz,
		'2027-02-01T00:00:00Z'::timestamptz
	),
	(
		'aaaaaaaa-0000-0000-0000-000000000004',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111114',
		'aaaaaaaa-2222-2222-2222-222222222224',
		0,
		'alpha candidate 4',
		'{}'::jsonb,
		4,
		0.10,
		'agent_private',
		0.20,
		'2026-01-31T00:00:00Z'::timestamptz,
		7,
		NULL,
		'2026-02-01T00:00:00Z'::timestamptz,
		'2027-02-01T00:00:00Z'::timestamptz
	),
	(
		'aaaaaaaa-0000-0000-0000-000000000005',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111115',
		'aaaaaaaa-2222-2222-2222-222222222225',
		0,
		'alpha candidate 5',
		'{}'::jsonb,
		5,
		0.05,
		'agent_private',
		0.10,
		'2026-01-31T00:00:00Z'::timestamptz,
		6,
		NULL,
		'2026-02-01T00:00:00Z'::timestamptz,
		'2027-02-01T00:00:00Z'::timestamptz
	),
	-- Trace 2
	(
		'bbbbbbbb-0000-0000-0000-000000000001',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111111',
		'bbbbbbbb-2222-2222-2222-222222222221',
		0,
		'beta candidate 1',
		'{}'::jsonb,
		1,
		0.95,
		'agent_private',
		0.50,
		'2026-02-01T00:00:00Z'::timestamptz,
		10,
		NULL,
		'2026-02-02T00:00:00Z'::timestamptz,
		'2027-02-02T00:00:00Z'::timestamptz
	),
	(
		'bbbbbbbb-0000-0000-0000-000000000002',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111112',
		'bbbbbbbb-2222-2222-2222-222222222222',
		0,
		'beta candidate 2',
		'{}'::jsonb,
		2,
		0.60,
		'agent_private',
		0.40,
		'2026-02-01T00:00:00Z'::timestamptz,
		9,
		NULL,
		'2026-02-02T00:00:00Z'::timestamptz,
		'2027-02-02T00:00:00Z'::timestamptz
	),
	(
		'bbbbbbbb-0000-0000-0000-000000000003',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111113',
		'bbbbbbbb-2222-2222-2222-222222222223',
		0,
		'beta candidate 3',
		'{}'::jsonb,
		3,
		0.50,
		'agent_private',
		0.30,
		'2026-02-01T00:00:00Z'::timestamptz,
		8,
		NULL,
		'2026-02-02T00:00:00Z'::timestamptz,
		'2027-02-02T00:00:00Z'::timestamptz
	),
	(
		'bbbbbbbb-0000-0000-0000-000000000004',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111114',
		'bbbbbbbb-2222-2222-2222-222222222224',
		0,
		'beta candidate 4',
		'{}'::jsonb,
		4,
		0.20,
		'agent_private',
		0.20,
		'2026-02-01T00:00:00Z'::timestamptz,
		7,
		NULL,
		'2026-02-02T00:00:00Z'::timestamptz,
		'2027-02-02T00:00:00Z'::timestamptz
	),
	(
		'bbbbbbbb-0000-0000-0000-000000000005',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111115',
		'bbbbbbbb-2222-2222-2222-222222222225',
		0,
		'beta candidate 5',
		'{}'::jsonb,
		5,
		0.10,
		'agent_private',
		0.10,
		'2026-02-01T00:00:00Z'::timestamptz,
		6,
		NULL,
		'2026-02-02T00:00:00Z'::timestamptz,
		'2027-02-02T00:00:00Z'::timestamptz
	);

INSERT INTO search_trace_items (
	item_id,
	trace_id,
	note_id,
	chunk_id,
	rank,
	final_score,
	explain
)
VALUES
	-- Trace 1 baseline top_k = 3 (ordered by rerank_score desc)
	(
		'cccccccc-0000-0000-0000-000000000001',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111111',
		'aaaaaaaa-2222-2222-2222-222222222221',
		1,
		1.00,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":1.0,"terms":[]}}'::jsonb
	),
	(
		'cccccccc-0000-0000-0000-000000000002',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111112',
		'aaaaaaaa-2222-2222-2222-222222222222',
		2,
		0.80,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":0.8,"terms":[]}}'::jsonb
	),
	(
		'cccccccc-0000-0000-0000-000000000003',
		'11111111-1111-1111-1111-111111111111',
		'aaaaaaaa-1111-1111-1111-111111111113',
		'aaaaaaaa-2222-2222-2222-222222222223',
		3,
		0.60,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":0.6,"terms":[]}}'::jsonb
	),
	-- Trace 2 baseline top_k = 3 (ordered by rerank_score desc)
	(
		'dddddddd-0000-0000-0000-000000000001',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111111',
		'bbbbbbbb-2222-2222-2222-222222222221',
		1,
		1.00,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":1.0,"terms":[]}}'::jsonb
	),
	(
		'dddddddd-0000-0000-0000-000000000002',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111112',
		'bbbbbbbb-2222-2222-2222-222222222222',
		2,
		0.75,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":0.75,"terms":[]}}'::jsonb
	),
	(
		'dddddddd-0000-0000-0000-000000000003',
		'22222222-2222-2222-2222-222222222222',
		'bbbbbbbb-1111-1111-1111-111111111113',
		'bbbbbbbb-2222-2222-2222-222222222223',
		3,
		0.60,
		'{"match":{"matched_terms":[],"matched_fields":[]},"ranking":{"schema":"search_ranking_explain/v2","policy_id":"baseline","final_score":0.6,"terms":[]}}'::jsonb
	);

COMMIT;

